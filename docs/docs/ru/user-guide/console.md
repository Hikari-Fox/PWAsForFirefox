# Руководство по консоли

Проект предоставляет консольную программу `firefoxpwa`, которую можно использовать для установки, запуска
и управления веб-приложениями вместо расширения.

Исполняемый файл должен автоматически добавляться в `PATH` при установке. Чтобы отобразить
встроенную справку, выполните `firefoxpwa --help` или `firefoxpwa <command> --help`.

Проект также предоставляет файлы завершения для оболочек Bash, Elvish, Fish, PowerShell и Zsh.

!!! note

    На Windows все файлы завершения устанавливаются в каталог `completions` в выбранном вами каталоге установки,
    но вам нужно вручную загрузить их в вашу оболочку. При использовании DEB- или RPM-пакетов или установке
    пакета из Homebrew или Arch, файлы завершения для Bash, Fish и Zsh автоматически устанавливаются в необходимые
    каталоги и загружаются оболочками.

    Для других операционных систем или оболочек вы можете найти предварительно собранные файлы завершения в
    артефактах сборки и вложениях релиза или собрать их вместе с проектом (они будут находиться в
    `target/{PROFILE}/completions`).

## Управление средой выполнения {: id="управление_средой_выполнения"}

Чтобы иметь возможность запускать веб-приложения, вам нужно скачать и установить среду выполнения Firefox:

```shell
firefoxpwa runtime install
```

Среда выполнения полностью отделена от вашей основной установки Firefox и не
влияет на неё или другие установки Firefox.

!!! note

    Чтобы установить среду выполнения на Windows, вам нужно установить [7-Zip](https://7-zip.org/).
    начнёт автоматически устанавливать 7-Zip, если он уже не установлен, что может потребовать
    разрешения Контроля учётных записей. Вы также можете самостоятельно установить 7-Zip или использовать уже установленный.
    После установки Runtime можете удалить 7-Zip.

!!! tip

    Вместо использования стандартной среды выполнения (обычного Firefox) вы можете вручную скачать альтернативную
    версию Firefox или форк Firefox (LibreWolf, IceCat, Waterfox и т. д.). Однако, пожалуйста, имейте в виду, что
    совместимость с другими или неофициальными средами выполнения не гарантируется.

    Вы можете ознакомиться с [ЧАВО](../help/faq.md#как_использовать_альтернативный_браузер_в_качестве_основного_браузера) для получения инструкций.

Вы можете удалить среду выполнения, но не сможете запускать веб-приложения, пока не установите её обратно:

```shell
firefoxpwa runtime uninstall
```

Вы также можете патчить среду выполнения с текущей глобально установленной версией патчей.

```shell
firefoxpwa runtime patch
```

Это полезно после (пере)установки пользовательской среды выполнения или если у вас возникают
проблемы с запуском веб-приложений. Вам также может понадобиться пропатчить профили, что вы
можете сделать [из расширения](extension.md#пропатчить_профили_и_среду_выполнения).

## Управление профилями {: id="управление_профилями"}

Веб-приложения используют отдельную систему профилей, отличную от обычного Firefox, поэтому данные, такие как установленные
расширения, пароли, логины и т. д., не делятся с вашим обычным профилем браузера. Это
используется для повышения надёжности веб-приложений и позволяет дополнительную настройку. Если вы хотите
синхронизировать данные между вашим основным и веб-профилем, рекомендуется использовать учётную запись Firefox
или стороннее решение для синхронизации.

По умолчанию веб-приложения устанавливаются в общий профиль с ID `00000000000000000000000000`.

Вы также можете создать отдельные изолированные профили и установить веб-приложения там, что позволяет
устанавливать несколько экземпляров одного и того же веб-приложения с разными учётными записями.

### Создание профиля {: id="создание_профиля"}

```shell
firefoxpwa profile create --name PROFILE-NAME --description PROFILE-DESCRIPTION --template PROFILE-TEMPLATE
```

Это создаст новый каталог профиля и вернёт его ID. Вам понадобится этот ID позже
для установки веб-приложений в профиль или его удаления.

Аргументы имени и описания являются необязательными. Если они опущены, они устанавливаются в пустые значения.

Аргумент шаблона также является необязательным. Если указан, всё содержимое предоставленного
каталога шаблона будет скопировано во вновь созданный профиль. Это полезно, если вы хотите
создать новый профиль с теми же расширениями, настройками и т. д., что и существующий.

!!! tip

    Если вы хотите использовать существующий профиль в качестве шаблона, убедитесь, что он не запущен
    перед копированием в качестве шаблона. В противном случае он будет содержать файлы блокировки, которые могут вызвать
    ошибки при создании или запуске профиля из шаблона. Вы можете проверить [ЧАВО](../help/faq.md#почему_я_не_могу_создать_профиль_используя_шаблон)
    для получения дополнительных деталей.

Вы можете ознакомиться с [списком доступных свойств и настроек профиля](../resources/profile-properties.md).

### Удаление профиля {: id="удаление_профиля"}

```shell
firefoxpwa profile remove ID
```

Это полностью удалит профиль и все веб-приложения, установленные в нём, **включая все
данные пользователя**. Вы не сможете полностью откатить это действие..

Стандартный профиль не может быть полностью удалён. Попытка удалить его просто очистит все
веб-приложения и данные пользователя, но сохранит ID профиля в списке профилей.

### Редактирование профиля {: id="редактирование_профиля"}

```shell
firefoxpwa profile update ID --name NEW-PROFILE-NAME --description NEW-PROFILE-DESCRIPTION
```

Это изменит имя и описание профиля, сохраняя установленные веб-приложения нетронутыми.

Оба аргумента являются необязательными. Пропущенные аргументы не изменят свойства профиля.
Установка аргументов в пустое значение очистит их свойства.

Также возможно применить шаблон профиля к существующему профилю, с аналогичным
поведением, как при [создании профиля](#создание_профиля).

### Список профилей {: id="список_профилей"}

```shell
firefoxpwa profile list
```

Это выведет все ваши профили и веб-приложения, установленные в них, включая их ID.
Вам понадобятся ID профилей, чтобы установить новое веб-приложение в отдельный профиль или удалить
профиль, а ID веб-приложений, чтобы запустить или удалить их.

## Управление веб-приложениями {: id="управление_веб-приложениями"}

### Установка веб-приложения {: id="установка_веб-приложения"}

```shell
firefoxpwa site install MANIFEST-URL --profile PROFILE-ID [...]
```

Это загрузит манифест веб-приложения, разберёт его и зарегистрирует веб-приложение в ОС. Это
также вернёт ID веб-приложения, который вам понадобится для его запуска.

Профиль является необязательным и по умолчанию будет использоваться общий профиль. Другие аргументы
доступны; вы можете ознакомиться с ними в справке программы. Вы также можете ознакомиться с [списком доступных
свойств и настроек веб-приложения](../resources/web-app-properties.md).

!!! warning

    Вы не можете повторно использовать одно и то же имя для нескольких веб-приложений, потому что новые могут перезаписать
    записи меню для существующих веб-приложений. Вам также следует быть осторожным, чтобы не повторно использовать имя
    существующего нативного приложения, так как оно также может перезаписать его запись меню.

    Вы не можете установить несколько экземпляров одного и того же веб-приложения в одном профиле,
    потому что они фактически будут одним и тем же экземпляром. Вместо этого установите каждый экземпляр
    в отдельный профиль.

### Удаление веб-приложения {: id="удаление_веб-приложения"}

```shell
firefoxpwa site uninstall ID
```

Это удалит веб-приложение и уберёт его из списка. Однако данные веб-приложения
останутся и будут повторно использованы, если вы позже установите его снова в том же профиле. Чтобы очистить
данные, сделайте это через браузер приложения или также удалите профиль.

### Обновление веб-приложения {: id="обновление_веб-приложения"}

```shell
firefoxpwa site update ID --name SITE-NAME --description SITE-DESCRIPTION [...]
```

Это изменит информацию о веб-приложении, такую как название, описание, иконка и т. д. Это
также (если не отключено) обновит манифест веб-приложения и иконки, а также повторно применит системную
интеграцию.

Вы можете ознакомиться со всеми доступными аргументами в справке программы. Пропущенные аргументы не
изменят свойства веб-приложения. Установка аргументов в пустое значение очистит их свойства.

### Запуск веб-приложения {: id="запуск_веб-приложения"}

```shell
firefoxpwa site launch ID
```

Это запустит среду выполнения браузера Firefox и откроет веб-приложение.

Чтобы запустить веб-приложение с пользовательским URL-адресом запуска, используйте аргумент `--url`. Когда режим вкладок
включен, вы можете указать этот аргумент несколько раз, чтобы запустить URL-адреса как несколько вкладок.
Чтобы запустить веб-приложение с обработчиком протокола (на поддерживаемых веб-приложениях), используйте аргумент `--protocol`.
