# Как это работает

Проект состоит из трёх частей: расширения браузера, нативной программы и модификаций UserChrome браузера. Эти части бесшовно интегрированы друг с другом, чтобы весь проект работал. Расширение предоставляет инструкции в браузере для установки нативной программы, которая также устанавливает модификации UserChrome.

Эта страница может быть полезна тем, кто хочет лучше понять, как работает проект и как он реализован.

## Расширение

Расширение браузера является основным интерфейсом, с которым пользователи будут сталкиваться при использовании проекта. Оно предоставляет удобный способ установки, редактирования и удаления сайтов и профилей непосредственно из основного браузера. Однако, поскольку [расширения браузера][link-webextensions] ограничены и не могут напрямую получать доступ к операционной системе, что необходимо для установки веб-приложений, проект использует [API нативного обмена сообщениями][link-native-messaging] для связи с нативной программой.

[link-webextensions]: https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions
[link-native-messaging]: https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging

## Нативная программа

Нативная программа написана на [Rust][link-rust] и обрабатывает функции, которые расширение само не может выполнить. Она общается с расширением, используя протокол нативного обмена сообщениями. Функции нативной программы включают установку среды выполнения Firefox, патчинг её с модификациями UserChrome, установку сайтов, применение системной интеграции и их запуск.

Нативная программа также предоставляет командную строку для пользователей, которые предпочитают CLI графическому интерфейсу.

[link-rust]: https://www.rust-lang.org/

## Модификации UserChrome

Оставшаяся часть проекта заключается в модификации интерфейса Firefox, чтобы создать более «приложенческий» вид. Это делается с помощью модификаций [UserChromeJS (Автоконфигурация скриптов запуска)][link-userchromejs], которые могут выполнять *низкоуровневый* JavaScript-код, который может изменять интерфейс Firefox. Эти модификации скрывают адресную строку и вкладки, перемещают некоторые кнопки браузера, предоставляют дополнительные полезные виджеты и настройки и обрабатывают область PWA и системную интеграцию.

[link-userchromejs]: https://www.userchrome.org/what-is-userchrome-js.html
